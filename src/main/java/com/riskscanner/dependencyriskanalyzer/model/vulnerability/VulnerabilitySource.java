package com.riskscanner.dependencyriskanalyzer.model.vulnerability;

/**
 * Enumeration of vulnerability data sources.
 *
 * <p>Each source provides vulnerability information with different
 * data formats, update frequencies, and coverage.
 */
public enum VulnerabilitySource {
    
    /**
     * Open Source Vulnerability database.
     * 
     * <p>Provides aggregated vulnerability data from multiple sources
     * with structured version ranges and ecosystem-specific information.
     */
    OSV("Open Source Vulnerability Database", "https://osv.dev"),
    
    /**
     * National Vulnerability Database (NVD).
     * 
     * <p>US government repository of CVEs with CVSS scores and detailed analysis.
     */
    NVD("National Vulnerability Database", "https://nvd.nist.gov"),
    
    /**
     * GitHub Advisory Database.
     * 
     * <p>GitHub-curated vulnerability database with focus on open source packages.
     */
    GITHUB("GitHub Advisory Database", "https://github.com/advisories"),
    
    /**
     * Maven Central metadata.
     * 
     * <p>Basic vulnerability information extracted from Maven Central package metadata.
     * Limited to what's available in package descriptors.
     */
    MAVEN_CENTRAL("Maven Central", "https://search.maven.org");
    
    private final String displayName;
    private final String baseUrl;
    
    VulnerabilitySource(String displayName, String baseUrl) {
        this.displayName = displayName;
        this.baseUrl = baseUrl;
    }
    
    public String getDisplayName() {
        return displayName;
    }
    
    public String getBaseUrl() {
        return baseUrl;
    }
    
    @Override
    public String toString() {
        return displayName;
    }

    /**
     * Gets the VulnerabilitySource from its display name.
     */
    public static VulnerabilitySource fromDisplayName(String displayName) {
        for (VulnerabilitySource source : values()) {
            if (source.displayName.equals(displayName)) {
                return source;
            }
        }
        throw new IllegalArgumentException("Unknown display name: " + displayName);
    }
}
