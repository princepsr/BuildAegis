package com.riskscanner.dependencyriskanalyzer.model.vulnerability;

/**
 * Vulnerability severity levels.
 *
 * <p>Normalized severity classification across different vulnerability sources.
 * Maps to CVSS scores and other severity indicators.
 */
public enum Severity {
    
    /**
     * Critical severity.
     * 
     * <p>CVSS score 9.0-10.0. Requires immediate attention.
     */
    CRITICAL("Critical", 9.0),
    
    /**
     * High severity.
     * 
     * <p>CVSS score 7.0-8.9. Important to address promptly.
     */
    HIGH("High", 7.0),
    
    /**
     * Medium severity.
     * 
     * <p>CVSS score 4.0-6.9. Should be addressed in normal maintenance.
     */
    MEDIUM("Medium", 4.0),
    
    /**
     * Low severity.
     * 
     * <p>CVSS score 0.1-3.9. Minor security impact.
     */
    LOW("Low", 0.1),
    
    /**
     * Informational.
     * 
     * <p>CVSS score 0.0. Security note or informational.
     */
    INFO("Informational", 0.0);
    
    private final String displayName;
    private final double minCvssScore;
    
    Severity(String displayName, double minCvssScore) {
        this.displayName = displayName;
        this.minCvssScore = minCvssScore;
    }
    
    public String getDisplayName() {
        return displayName;
    }
    
    public double getMinCvssScore() {
        return minCvssScore;
    }
    
    /**
     * Maps CVSS score to severity level.
     * 
     * @param cvssScore CVSS score (0.0-10.0)
     * @return corresponding severity level
     */
    public static Severity fromCvssScore(double cvssScore) {
        if (cvssScore >= CRITICAL.minCvssScore) {
            return CRITICAL;
        } else if (cvssScore >= HIGH.minCvssScore) {
            return HIGH;
        } else if (cvssScore >= MEDIUM.minCvssScore) {
            return MEDIUM;
        } else if (cvssScore > INFO.minCvssScore) {
            return LOW;
        } else {
            return INFO;
        }
    }
    
    @Override
    public String toString() {
        return displayName;
    }
}
