package com.riskscanner.dependencyriskanalyzer.model.vulnerability;

/**
 * Represents the confidence level in a vulnerability finding.
 *
 * <p>Confidence is computed based on factors like source reliability,
 * artifact match accuracy, and cross-source confirmation.
 */
public enum ConfidenceLevel {
    HIGH("High Confidence", 80, 100, "Multiple reliable sources confirm this vulnerability with exact artifact matches"),
    MEDIUM("Medium Confidence", 50, 79, "Single reliable source or multiple sources with fuzzy matches"),
    LOW("Low Confidence", 0, 49, "Limited source information or only fuzzy matches");

    private final String displayName;
    private final int minScore;
    private final int maxScore;
    private final String description;

    ConfidenceLevel(String displayName, int minScore, int maxScore, String description) {
        this.displayName = displayName;
        this.minScore = minScore;
        this.maxScore = maxScore;
        this.description = description;
    }

    public String getDisplayName() {
        return displayName;
    }

    public int getMinScore() {
        return minScore;
    }

    public int getMaxScore() {
        return maxScore;
    }

    public String getDescription() {
        return description;
    }

    /**
     * Determines the confidence level based on a numerical score.
     */
    public static ConfidenceLevel fromScore(int score) {
        if (score >= HIGH.minScore) {
            return HIGH;
        } else if (score >= MEDIUM.minScore) {
            return MEDIUM;
        } else {
            return LOW;
        }
    }

    @Override
    public String toString() {
        return displayName;
    }
}
