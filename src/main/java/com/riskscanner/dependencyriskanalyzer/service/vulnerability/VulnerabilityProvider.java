package com.riskscanner.dependencyriskanalyzer.service.vulnerability;

import com.riskscanner.dependencyriskanalyzer.model.DependencyCoordinate;
import com.riskscanner.dependencyriskanalyzer.model.vulnerability.Vulnerability;
import com.riskscanner.dependencyriskanalyzer.model.vulnerability.VulnerabilitySource;

import java.util.List;

/**
 * Interface for vulnerability data providers.
 *
 * <p>Implementations fetch vulnerability information from various sources
 * and normalize them into the common {@link Vulnerability} model.
 */
public interface VulnerabilityProvider {
    
    /**
     * Gets the source type for this provider.
     * 
     * @return the vulnerability source
     */
    VulnerabilitySource getSource();
    
    /**
     * Retrieves vulnerabilities for the given dependency.
     * 
     * @param dependency the dependency coordinate to check
     * @return list of vulnerabilities affecting this dependency
     */
    List<Vulnerability> getVulnerabilities(DependencyCoordinate dependency);
    
    /**
     * Checks if this provider supports offline operation.
     * 
     * @return true if provider can work without network access
     */
    boolean supportsOffline();
    
    /**
     * Gets the priority of this provider for dependency resolution.
     * Lower numbers indicate higher priority.
     * 
     * @return priority value (1-10, where 1 is highest priority)
     */
    default int getPriority() {
        return 5; // Default medium priority
    }
    
    /**
     * Checks if this provider is available and healthy.
     * 
     * @return true if provider is operational
     */
    default boolean isHealthy() {
        return true; // Default to healthy
    }
    
    /**
     * Gets a description of this provider.
     * 
     * @return provider description
     */
    default String getDescription() {
        return "Vulnerability provider for " + getSource().getDisplayName();
    }
}
